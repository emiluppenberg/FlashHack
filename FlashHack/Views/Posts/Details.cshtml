@model FlashHack.Models.Post

@{
    ViewData["Title"] = "Details";
    @inject IHttpContextAccessor HttpContextAccessor
    var userId = HttpContextAccessor.HttpContext.Session.GetInt32("UserId");
    var postId = Model.Id;
}

<div class="container mt-4">
    <div class="card mb-3 post-item">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h3>@Model.Title</h3>
            <i class="fa-regular fa-star star-icon" onclick="toggleStar(this)"></i>
        </div>
        <div class="card-body">
            <p>@Model.Content</p>
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <i class="fa-solid fa-thumbs-up thumbs-icon" onclick="toggleThumbs(this, 'up')"></i> @Model.UpVotes
                    <i class="fa-solid fa-thumbs-down thumbs-icon ms-3" onclick="toggleThumbs(this, 'down')"></i> @Model.DownVotes
                    <i class="fa-solid fa-comments ms-3"></i> @Model.Comments.Count
                </div>
                <div>
                    <span class="text-muted">by <a asp-controller="Users" asp-action="Profile" asp-route-id="@Model.User.Id">@Model.User.FirstName @Model.User.LastName</a></span>
                </div>
            </div>
            <div>
                <p>
                    <a asp-action="Create" asp-controller="Comments" asp-route-userId="@userId" asp-route-postId="@postId" asp-route-returnUrl="@Context.Request.Path"> Answer</a>
                </p>
            </div>
            <div class="mt-3">
                <h5>Comments:</h5>
                <ul class="list-group">
                    @foreach (var comment in Model.Comments)
                    {
                        <li class="list-group-item">
                            <strong>@comment.User.FirstName @comment.User.LastName:</strong> @comment.Content
                        </li>
                    }
                </ul>
            </div>
        </div>
    </div>
    <div class="mt-3">
        <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-primary">Edit</a>
        <a asp-action="Index" class="btn btn-secondary">Back to List</a>
    </div>
</div>

<script>
    function toggleStar(element) {
        element.classList.toggle('fa-solid');
        element.classList.toggle('fa-regular');
    }

    function toggleThumbs(element, type) {
        const thumbsUp = document.querySelector('.fa-thumbs-up');
        const thumbsDown = document.querySelector('.fa-thumbs-down');

        if (type === 'up') {
            thumbsUp.classList.toggle('selected');
            thumbsDown.classList.remove('selected');
        } else {
            thumbsDown.classList.toggle('selected');
            thumbsUp.classList.remove('selected');
        }
    }
</script>

